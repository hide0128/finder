# 企業情報ファインダー 要件定義書

## 1. システム概要

### 1.1 システム名称
企業情報ファインダー（Company Information Finder）

### 1.2 システム目的
日本企業の会社名を入力することで、以下の企業情報を自動取得し、ユーザーに提供するWebアプリケーション：
- 企業の公式ドメイン名
- 企業本社の郵便番号

### 1.3 システムの特徴
- Google検索APIを活用したAI駆動の企業情報検索
- 複数企業の一括検索機能
- 検索結果のエクスポート機能（Excel形式、タブ区切りテキスト）
- 日本語対応のユーザーインターフェース

## 2. 機能要件

### 2.1 企業名入力機能
- **機能**: ユーザーが検索対象の企業名を入力
- **詳細**:
  - テキストエリアによる複数行入力対応
  - 1行につき1つの企業名
  - 会社名末尾の注釈（例："-2(移管)"）の自動除去
  - 入力内容の妥当性検証（URL、メールアドレス、電話番号等の除外）

### 2.2 企業情報検索機能
- **機能**: 入力された企業名に基づく企業情報の自動取得
- **詳細**:
  - Google Gemini API（gemini-2.5-flash-preview-04-17）を使用
  - Google検索機能を活用した公式サイト特定
  - 以下の情報を抽出：
    - 企業名（入力された名称をそのまま保持）
    - 公式ドメイン名（www.プレフィックス除去、ルートドメインのみ）
    - 本社郵便番号（日本形式：123-4567）
  - 複数企業の並列処理による高速検索
  - エラーハンドリングによる部分的失敗時の継続処理

### 2.3 検索結果表示機能
- **機能**: 取得した企業情報の整理された表示
- **詳細**:
  - 企業ごとのカード形式での情報表示
  - 情報源URL（検索で参照したサイト）の表示
  - 検索件数の表示
  - "情報なし"の場合の適切な表示

### 2.4 データエクスポート機能
- **機能**: 検索結果の外部ファイル出力
- **詳細**:
  - Excel（.xlsx）形式でのダウンロード
  - タブ区切りテキスト形式でのコピー機能
  - 出力カラムの選択機能（企業名、ドメイン、郵便番号）
  - ファイル名の自動設定

### 2.5 エラーハンドリング機能
- **機能**: システムエラーの適切な処理と表示
- **詳細**:
  - APIキーエラーの検出と表示
  - ネットワークエラーの処理
  - 部分的失敗時の詳細エラー情報表示
  - ユーザーフレンドリーなエラーメッセージ

## 3. 非機能要件

### 3.1 パフォーマンス要件
- 複数企業の並列検索による処理時間短縮
- レスポンシブデザインによる様々なデバイスでの快適な利用

### 3.2 ユーザビリティ要件
- 直感的なユーザーインターフェース
- ローディング状態の明確な表示
- 検索進捗の可視化
- アクセシビリティ配慮（aria-label等の実装）

### 3.3 セキュリティ要件
- API key の環境変数による管理
- XSS攻撃対策
- 入力値のサニタイズ処理

### 3.4 信頼性要件
- エラー時の適切なフォールバック処理
- API呼び出しの失敗に対する回復性
- データの整合性保証

## 4. 技術仕様

### 4.1 フロントエンド
- **フレームワーク**: React 19.1.0
- **言語**: TypeScript 5.7.2
- **ビルドツール**: Vite 6.2.0
- **スタイリング**: Tailwind CSS（CDN経由）

### 4.2 バックエンド/API
- **AI API**: Google Gemini API (gemini-2.5-flash-preview-04-17)
- **検索機能**: Google Search Integration
- **APIキー管理**: 環境変数（GEMINI_API_KEY）

### 4.3 外部ライブラリ
- **Excelエクスポート**: xlsx 0.18.5
- **型定義**: @types/node 22.14.0

### 4.4 アーキテクチャ
- Single Page Application (SPA)
- Component-based architecture
- Service layer pattern (geminiService.ts)
- TypeScript による型安全性

## 5. データ構造

### 5.1 CompanyInfo型
```typescript
interface CompanyInfo {
  companyName: string;     // 企業名
  domain: string;          // ドメイン名
  postalCode: string;      // 郵便番号
  sourceUrls?: Array<{     // 情報源URL（オプション）
    uri: string;
    title: string;
  }>;
}
```

### 5.2 ApiError型
```typescript
interface ApiError {
  message: string;         // エラーメッセージ
  code?: number;          // エラーコード（オプション）
}
```

## 6. ユーザーフロー

### 6.1 基本検索フロー
1. ユーザーが企業名をテキストエリアに入力
2. 検索ボタンをクリック
3. システムが入力内容を妥当性検証
4. 複数企業の並列検索実行
5. 検索結果の表示
6. 必要に応じてエクスポート機能の利用

### 6.2 エラー処理フロー
1. 検索中にエラーが発生
2. エラーの種類を判定
3. 適切なエラーメッセージを表示
4. 部分的成功の場合は取得済み結果を表示

## 7. 運用要件

### 7.1 環境設定
- Node.js環境が必要
- Gemini APIキーの取得と設定が必要
- 開発環境：`npm run dev`
- プロダクションビルド：`npm run build`

### 7.2 デプロイメント
- 静的サイトとしてのデプロイ可能
- 環境変数の適切な設定が必要
- HTTPS環境での運用推奨

## 8. 制約事項

### 8.1 API制約
- Google Gemini APIの利用制限に依存
- 検索精度はAIモデルの性能に依存
- API料金が発生する可能性

### 8.2 データ制約
- 日本企業の情報に特化
- リアルタイムの情報更新は保証されない
- 一部企業の情報が取得できない場合がある

### 8.3 技術制約
- モダンブラウザでの動作を前提
- JavaScript有効環境が必要
- インターネット接続が必要

## 9. 将来の拡張可能性

### 9.1 機能拡張
- 企業情報の詳細化（住所、電話番号、代表者名等）
- 検索履歴機能
- お気に入り企業の保存機能
- CSVエクスポート対応

### 9.2 技術拡張
- データベース統合
- ユーザー認証機能
- API制限対策（キャッシュ機能）
- 多言語対応

この要件定義書は、現在のシステム実装に基づいて作成されており、システムの理解と今後の開発・保守の指針として活用できます。